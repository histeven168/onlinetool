const favoriteBtn=document.getElementById('favoriteBtn');if(favoriteBtn){favoriteBtn.addEventListener('click',function(){if(typeof iflogin!=='undefined'&&iflogin!=1){const loginDialog=setupLoginDialog();if(loginDialog){loginDialog.show()}else{showToast(_LANG.continue_by_sign,false)}return}if(this.dataset.lastClick&&Date.now()-this.dataset.lastClick<10000){showToast(_LANG.try_again_later,false);return}this.dataset.lastClick=Date.now();const icon=this.querySelector('i');const isFavorited=this.classList.contains('favorited');if(!isFavorited){this.classList.add('favorited');icon.classList.replace('fa-heart-empty','fa-heart')}const formData=new FormData();formData.append('id',tool_id);formData.append('toolname',tool_name);formData.append('img_path',tool_image);formData.append('url',tool_url);fetch(wwwdomain+'/?mod=submitFav',{method:'POST',body:formData,credentials:'include'}).then(response=>response.json()).then(data=>{if(data.success){if(data.action==='addFav'){showToast(_LANG.added_from_fav,true)}else{this.classList.remove('favorited');icon.classList.replace('fa-heart','fa-heart-empty');showToast(_LANG.removed_from_fav,true)}}else{this.classList.remove('favorited');icon.classList.replace('fa-heart','fa-heart-empty');showToast(_LANG.try_again_later,false)}}).catch(error=>{console.error('Error:',error);this.classList.remove('favorited');icon.classList.replace('fa-heart','fa-heart-empty');showToast(_LANG.try_again_later,false)})})}document.addEventListener('DOMContentLoaded',function(){const ratingContainers=document.querySelectorAll('.rating');ratingContainers.forEach(container=>{const stars=container.querySelectorAll('.star');const currentRating=parseFloat(container.getAttribute('data-current-rating'));let isRated=container.classList.contains('disabled');initStars(stars,currentRating);if(!isRated){stars.forEach(star=>{star.addEventListener('mouseenter',function(){const hoverValue=parseInt(this.getAttribute('data-value'));updateStars(stars,hoverValue,false)});star.addEventListener('click',function(){const clickedValue=parseInt(this.getAttribute('data-value'));container.setAttribute('data-current-rating',clickedValue);isRated=true;container.classList.add('disabled');submitRating(container,clickedValue)})});container.addEventListener('mouseleave',function(){updateStars(stars,currentRating,false)})}});function initStars(stars,rating){const fullStars=Math.floor(rating);const hasHalfStar=rating%1>=0.5;stars.forEach((star,index)=>{const starValue=index+1;if(starValue<=fullStars){star.classList.add('filled')}else if(starValue===fullStars+1&&hasHalfStar){star.classList.add('half')}else{star.classList.remove('filled','half')}})}function updateStars(stars,value,isPermanent){stars.forEach(star=>{const starValue=parseInt(star.getAttribute('data-value'));star.classList.toggle('filled',starValue<=value);star.classList.remove('half');if(isPermanent){star.classList.remove('hovered')}})}function submitRating(container,rating){const toolId=container.getAttribute('data-tool-id');const adjustedRating=rating<=4?4:rating;fetch(wwwdomain+'/?mod=submitRating',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded',},body:`id=${toolId}&rating=${adjustedRating}`}).then(response=>response.json()).then(data=>{if(data.success){showToast(_LANG.thankyou,true);const countElement=container.querySelector('.count');if(countElement){const currentCount=parseInt(countElement.textContent);countElement.textContent=currentCount+1}}else{showToast(data.message==='-1'?_LANG.voted_today:data.message||_LANG.try_again_later,false);container.classList.remove('disabled')}}).catch(error=>{showToast(_LANG.try_again_later,false);container.classList.remove('disabled');console.error('Error:',error)})}});